# 4강 역행렬

## 1. 정칙행렬과 역행렬의 정의

### 1.1. 역행렬(Inverse Matrix)의 정의

**n차 정방행렬** A에 대해 행렬 B가 존재하여 다음을 만족할 때:
$$AB = BA = I_n$$

행렬 B를 A의 **역행렬(inverse matrix)**이라 하고 $A^{-1}$로 표기한다.

**핵심 개념**:
1.  **정칙행렬(nonsingular matrix)** 또는 **가역행렬(invertible matrix)**: 역행렬이 존재하는 행렬
2.  **특이행렬(singular matrix)**: 역행렬이 존재하지 않는 행렬
3.  **유일성**: 역행렬이 존재하면 유일하다

**예시**:
$A = \begin{pmatrix} 1 & 2 \\ 1 & 3 \end{pmatrix}$, $B = \begin{pmatrix} 3 & -2 \\ -1 & 1 \end{pmatrix}$

**검증**: 
$$AB = \begin{pmatrix} 1 & 2 \\ 1 & 3 \end{pmatrix}\begin{pmatrix} 3 & -2 \\ -1 & 1 \end{pmatrix} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} = I_2$$
$$BA = \begin{pmatrix} 3 & -2 \\ -1 & 1 \end{pmatrix}\begin{pmatrix} 1 & 2 \\ 1 & 3 \end{pmatrix} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} = I_2$$

따라서 A는 정칙행렬이고 B는 A의 역행렬이다.

### 1.2. 역행렬의 유일성

**정리**: A의 역행렬을 B와 C, 즉 2개가 있다고 가정하면:
- $AB = BA = I$
- $AC = CA = I$

그러면:
$$B = BI = B(AC) = (BA)C = IC = C$$

따라서 B와 C는 같을 수밖에 없다. 즉, 역행렬은 유일하다.

---

## 2. 2×2 행렬의 역행렬

### 2.1. 2×2 행렬의 역행렬 공식

2차 정방행렬 $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$와 이에 대한 역행렬 $A^{-1} = \begin{pmatrix} x & y \\ z & w \end{pmatrix}$가 다음을 만족한다고 하자:

$$AA^{-1} = \begin{pmatrix} a & b \\ c & d \end{pmatrix}\begin{pmatrix} x & y \\ z & w \end{pmatrix} = \begin{pmatrix} ax + bz & ay + bw \\ cx + dz & cy + dw \end{pmatrix} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}$$

여기서 2개의 일차연립방정식을 얻는다:
$$\begin{cases}
ax + bz = 1 & ay + bw = 0 \\
cx + dz = 0 & cy + dw = 1
\end{cases}$$

각각 x, z와 y, w에 대한 미지수의 계수에 풀면 $D = ad - bc \neq 0$ 조건 하에 다음이 성립한다:

$$x = \frac{d}{D}, y = \frac{-b}{D}, z = \frac{-c}{D}, w = \frac{a}{D}$$

따라서 2차 정방행렬의 역행렬은 $D = ad - bc \neq 0$일 때,

$$A^{-1} = \frac{1}{D}\begin{pmatrix} d & -b \\ -c & a \end{pmatrix}$$

### 2.2. 계산 예시

**예시 1**: $A = \begin{pmatrix} 2 & 1 \\ 5 & 3 \end{pmatrix}$

$D = 2 \times 3 - 1 \times 5 = 6 - 5 = 1$이므로:
$$A^{-1} = \begin{pmatrix} 3 & -1 \\ -5 & 2 \end{pmatrix}$$

**예시 2**: $B = \begin{pmatrix} 5 & 3 \\ 7 & 4 \end{pmatrix}$

$D = 5 \times 4 - 3 \times 7 = 20 - 21 = -1$이므로:
$$B^{-1} = \begin{pmatrix} -4 & 3 \\ 7 & -5 \end{pmatrix}$$

**예시 3**: $C = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$

$D = 1 \times 4 - 2 \times 3 = 4 - 6 = -2$이므로:
$$C^{-1} = \frac{1}{-2}\begin{pmatrix} 4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ \frac{3}{2} & -\frac{1}{2} \end{pmatrix}$$

한편, 정칙행렬 A에 관해 임의의 자연수 n에 대해 $A^{-n} = (A^{-1})^n$으로 정의한다면 3장에서 정의한 거듭제곱을 정칙행렬에 관해 확장할 수 있다. 즉, 임의의 정수 r, s에 대해 다음이 성립한다:

$$A^r A^s = A^{r+s}, (A^r)^s = A^{rs}$$

---

## 3. 역행렬의 성질

### 3.1. 기본 성질들

**정리 4.2**: A, B가 n차 정칙행렬이면 다음이 성립한다.

1.  $(A^{-1})^{-1} = A$
2.  $(AB)^{-1} = B^{-1}A^{-1}$ (**순서 주의**)
3.  $(cA)^{-1} = \frac{1}{c}A^{-1}$ (c가 0이 아닌 상수일 때)
4.  $(A^T)^{-1} = (A^{-1})^T$

### 3.2. 성질 증명 예시

**$(AB)^{-1} = B^{-1}A^{-1}$ 증명**:

$(AB)(B^{-1}A^{-1})$을 계산해보자:
$$(AB)(B^{-1}A^{-1}) = A(BB^{-1})A^{-1} = AIA^{-1} = AA^{-1} = I$$

마찬가지로:
$$(B^{-1}A^{-1})(AB) = B^{-1}(A^{-1}A)B = B^{-1}IB = B^{-1}B = I$$

따라서 $B^{-1}A^{-1}$은 $AB$의 역행렬이다.

### 3.3. m개의 n차 정칙행렬에 대한 일반화

**따름정리**: $A_1, A_2, \cdots, A_m$을 m개의 n차 정칙행렬이라 하면 다음이 성립한다.

$$(A_1 A_2 \cdots A_m)^{-1} = A_m^{-1} A_{m-1}^{-1} \cdots A_2^{-1} A_1^{-1}$$

즉, m개의 n차 정칙행렬을 차례로 곱해서 만들어진 행렬의 역행렬은 각 행렬의 역행렬을 역순으로 곱한 것과 같다.

---

## 4. 역행렬 구하는 방법 (가우스-조던 소거법)

### 4.1. 기본행렬(Elementary Matrix)

**정의 4.2**: n차 단위행렬 $I_n$에 기본행연산을 한 번만 적용하여 얻는 행렬 E를 **기본행렬(elementary matrix)**이라고 한다.

기본행연산이 세 종류가 있으므로 기본행렬도 세 종류가 있다:
- [정의 2.1]에서 정의한 기본행연산 $R_{i,j}$, $R_i(c)$, $R_{i,j}(c)$에 대한 기본행렬을 각각 $E_{i,j}$, $E_i(c)$, $E_{i,j}(c)$로 나타내기로 한다.

**예시 (3×3 기본행렬들)**:
$$E_{1,3} = \begin{pmatrix} 0 & 0 & 1 \\ 0 & 1 & 0 \\ 1 & 0 & 0 \end{pmatrix}, \quad E_2(3) = \begin{pmatrix} 1 & 0 & 0 \\ 0 & 3 & 0 \\ 0 & 0 & 1 \end{pmatrix}, \quad E_{1,3}(2) = \begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 2 & 0 & 1 \end{pmatrix}$$

### 4.2. 기본행렬의 성질

**정리 4.4**: 기본행렬은 정칙행렬이며 그 역행렬은 동일한 종류의 기본행렬이다.

각각에 대해 다음이 성립한다:
1.  $E_{i,j} E_{i,j} = I$, 따라서 $E_{i,j}^{-1} = E_{i,j}$
2.  $E_i(c) E_i(\frac{1}{c}) = I$, 따라서 $E_i(c)^{-1} = E_i(\frac{1}{c})$
3.  $E_{i,j}(c) E_{i,j}(-c) = I$, 따라서 $E_{i,j}(c)^{-1} = E_{i,j}(-c)$

### 4.3. 가우스-조던 소거법을 이용한 역행렬 계산

**알고리즘 4.1**: $A^{-1}$을 구하는 방법

**입력**: n차 정방행렬 A
**출력**: $A^{-1}$의 존재 여부와 존재할 경우 $A^{-1}$

**단계 1**: $n \times 2n$인 확대행렬 $(A|I_n)$을 구성한다.

**단계 2**: 기본행연산을 $(A|I_n)$에 적용하여 소거행제형 행렬 $(B|C)$를 만든다.

**단계 3**: 만일 $B = I_n$이면 $C = A^{-1}$을 출력한다.

만일 $B \neq I_n$이면 B는 영행을 갖게 되므로 A는 정칙행렬이 아니며, 따라서 역행렬 $A^{-1}$이 존재하지 않음을 출력한다.

### 4.4. 계산 예시

**예제 4.7**: 다음 3차 정방행렬 A, B에 대해서 역행렬이 있으면 구하라.

$A = \begin{pmatrix} 1 & 2 & 3 \\ 3 & 5 & 7 \\ 2 & 6 & 9 \end{pmatrix}$, $B = \begin{pmatrix} 1 & 1 & 1 \\ 2 & 1 & 3 \\ 5 & 3 & 7 \end{pmatrix}$

**(1) 행렬 A에 대해 확대행렬 $(A|I_3)$을 구성한 후 기본행연산을 적용하여 소거행제형으로 변환한다.**

$$(A|I_3) = \begin{pmatrix} 1 & 2 & 3 & 1 & 0 & 0 \\ 3 & 5 & 7 & 0 & 1 & 0 \\ 2 & 6 & 9 & 0 & 0 & 1 \end{pmatrix}$$

$R_{1,2}(-3)$: 
$$\begin{pmatrix} 1 & 2 & 3 & 1 & 0 & 0 \\ 0 & -1 & -2 & -3 & 1 & 0 \\ 2 & 6 & 9 & 0 & 0 & 1 \end{pmatrix}$$

$R_{1,3}(-2)$:
$$\begin{pmatrix} 1 & 2 & 3 & 1 & 0 & 0 \\ 0 & -1 & -2 & -3 & 1 & 0 \\ 0 & 2 & 3 & -2 & 0 & 1 \end{pmatrix}$$

$R_2(-1)$:
$$\begin{pmatrix} 1 & 2 & 3 & 1 & 0 & 0 \\ 0 & 1 & 2 & 3 & -1 & 0 \\ 0 & 2 & 3 & -2 & 0 & 1 \end{pmatrix}$$

계속 소거 과정을 거쳐 최종적으로:
$$\begin{pmatrix} 1 & 0 & 0 & 3 & 0 & -1 \\ 0 & 1 & 0 & -13 & 3 & 2 \\ 0 & 0 & 1 & 8 & -2 & -1 \end{pmatrix} = (I_3|C)$$

$B = I_3$이므로 $A^{-1} = C = \begin{pmatrix} 3 & 0 & -1 \\ -13 & 3 & 2 \\ 8 & -2 & -1 \end{pmatrix}$

---

## 5. 일차연립방정식과 역행렬

### 5.1. 일차연립방정식의 해법

제2장에서 일차연립방정식을 행렬방정식 $AX = B$ 형태로 표현하고, 확대행렬 $C = (A|B)$에 적절한 기본행연산을 적용함으로써 해를 구하는 것을 다뤘다.

**일차연립방정식**:
$$\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots + a_{mn}x_n = b_n
\end{cases}$$

에 대한 계수행렬을 A, 미지수행렬을 X, 상수행렬을 B라 하면:

$$AX = B$$

### 5.2. 해의 존재 조건

가우스-조던 소거법은 확대행렬 $(A|B)$를 소거행제형 행렬 $(C|D)$로 변환한다.

**해의 존재 조건**:
1.  행렬 $(C|D)$의 어느 행이 $(0 \; 0 \; \cdots \; 0 | k)$ (단, $k \neq 0$) 형태가 있으면 해가 없다.
2.  C에서 영행이 아닌 행의 수를 r이라 할 때:
    - $r = n$인 경우: 유일한 해를 갖는다.
    - $r < n$인 경우: 무수히 많은 해를 갖는다 ((n-r)개의 자유변수 존재).

### 5.3. 역행렬을 이용한 해법

**정리 4.8**: A가 n차 정칙행렬이면 임의의 n × 1 행렬 B에 대해 행렬방정식 $AX = B$는 유일한 해 $X = A^{-1}B$를 갖는다.

**예시**: 
$$\begin{cases} x + 3y = 2 \\ 2x + 6y = 4 \end{cases}$$

주어진 연립방정식은 $x = -1, y = 1$일 때 성립하므로 $Y = (-1, 1)$은 하나의 해이다. 다음으로 동차방정식 $AX = O$는:

$$\begin{cases} x + 3y = 0 \\ 2x + 6y = 0 \end{cases}$$

$y = t$로 치환하면 모든 실수 t에 대하여 $X_0 = (-3t, t)$가 $AX = O$의 해가 된다. [정리 4.11]에 의해 해는 모든 실수 t에 대하여 $X_0 + Y = (-3t, t) + (-1, 1) = (-1 - 3t, 1 + t)$로 표시된다.

---

## 6. 동차연립방정식

### 6.1. 동차연립방정식(Homogeneous Linear System)

동차연립방정식이란 방정식 $AX = B$에서 $B = O$인 경우이다. 동차연립방정식 $AX = O$는 항상 자명한 해 $X = O$를 갖는다.

**정리 4.9**: n차 정방행렬 A가 $I_n$과 행상등하기 위한 필요충분조건은 동차연립방정식 $AX = O$가 오직 자명한 해만 갖는 것이다.

### 6.2. 동차연립방정식의 성질

A가 정방행렬로서 $I_n$과 행상등하고 가정하자. 그러면 방정식 $AX = O$와 $I_n X = O$는 동일한 해를 갖는다. 앞서서 A와 $I_n$이 행상등하면 $(A|O)$와 $(I_n|O)$도 행상등하고 [정리 2.1]에 따라 $AX = O$와 $I_n X = O$는 상등하기 때문이다. $I_n X = O$는 $X = O$만 해로 갖는다. 따라서 $AX = O$도 $X = O$만 해로 갖는다.

반대로 $AX = O$가 오직 $X = O$만 해로 갖는다고 하자. A를 소거행제형으로 바꾼 것이 R이라 하면 $AX = O$와 $RX = O$는 동일한 해를 갖는다.

가정에서 $AX = O$가 오직 $X = O$만 해로 갖았으므로 $RX = O$도 $X = O$만 해로 갖는다. 만일 $R \neq I_n$이라면 R은 영행을 포함하게 되므로 자명하지 않은 해가 존재하게 된다. 이는 모순이므로 $R = I_n$이다. 결국 A는 $I_n$과 행상등하다.

### 6.3. 비동차연립방정식과의 관계

**정리 4.11**: $AX = B$의 한 해를 Y라 하고 $AX = O$의 임의의 해를 $X_0$라 하면, $AX = B$의 모든 해는 $X_0 + Y$로 표시된다.

---

## 7. 정칙행렬의 특성 정리

**정리 4.10**: n차 정방행렬 A에 대한 다음 성질은 서로 동치이다.

1.  A는 정칙행렬이다.
2.  A는 $I_n$과 행상등하다.
3.  A는 유한개의 n차 기본행렬의 곱이다.
4.  $AX = O$는 오직 자명한 해만 갖는다.
5.  임의의 n × 1행렬 B에 대해 $AX = B$는 유일한 해를 갖는다.

**증명의 개요**:
- [정리 4.5]에 의해 (1), (2), (3)은 서로 동치이다. 
- [정리 4.9]에 의해 (1), (2), (3), (4)는 서로 동치이다. 
- [정리 4.8]에 의해 (5)도 동치이다.

---

## 8. 종합 정리

**요약**:

• n차 정방행렬 A에 대해 $AB = BA = I_n$을 만족하는 행렬 B가 존재할 때 A를 정칙행렬이라 하며, B를 A의 역행렬 $A^{-1}$이라 한다.

• A가 정칙행렬이면 $A^{-1}$은 유일하다.

• 임의의 2차 정방행렬 $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$의 역행렬은 $D = ad - bc \neq 0$일 때 $A^{-1} = \frac{1}{D}\begin{pmatrix} d & -b \\ -c & a \end{pmatrix}$이다.

• A와 B가 정칙행렬이면 $A^{-1}$, $AB$, $cA$, $A^T$도 정칙행렬이다(c는 0이 아닌 상수). 즉, $(A^{-1})^{-1} = A$, $(AB)^{-1} = B^{-1}A^{-1}$, $(cA)^{-1} = \frac{1}{c}A^{-1}$, $(A^T)^{-1} = (A^{-1})^T$이다.

• 단위행렬에 기본행연산을 한 번만 적용하여 얻는 행렬을 기본행렬이라고 하는데, 기본행연산 $R_{i,j}$, $R_i(c)$, $R_{i,j}(c)$ 각각에 대응하여 기본행렬도 $E_{i,j}$, $E_i(c)$, $E_{i,j}(c)$와 같이 세 종류가 있다.

• 정칙행렬과 단위행렬은 행상등하므로 정칙행렬은 기본행렬의 곱으로 표현된다.

• n차 정방행렬 A에 대해 $A^{-1}$을 구하려면 확대행렬 $(A|I_n)$을 기본행연산으로 $(I_n|A^{-1})$ 형태로 변환한다. 이때 $B = I_n$이면 $A^{-1} = C$이지만 $B \neq I_n$이면 $A^{-1}$은 존재하지 않는다.

• 정칙행렬의 특성을 정리하면 [정리 4.10]과 같다.

• A가 정칙행렬이면 일차연립방정식 $AX = B$는 $X = A^{-1}B$로 해를 구할 수 있으며 $AX = O$는 자명한 해만 갖는다.