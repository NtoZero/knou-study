# 제6장. 크래머 공식과 역행렬

## 개요

행렬로 표현한 일차연립방정식 AX = B를 해결하는 방법에는 기본행연산을 이용하여 해를 구하는 방법과 계수행렬 A의 역행렬을 이용하는 방법이 존재함. 이 장에서는 행렬식의 개념을 이용하여 주어진 일차연립방정식의 해를 구하는 두 가지 방법으로 크래머 공식(Cramer's rule)에 의한 방법과 역행렬을 이용하는 방법에 대해 설명함. 크래머 공식은 행렬식 개념을 활용하여 해를 갖는 일차연립방정식에 한하여 적용할 수 있는 공식이며, 역행렬 방법은 마찬가지로 해를 갖는 일차연립방정식에 한하여 먼저 행렬식을 이용해서 역행렬을 구한 다음 그 역행렬을 이용해서 해를 구하는 방법임.

---

## 6.1 크래머 공식

### 기본 개념

일차연립방정식을 행렬방정식 AX = B로 표현하고 행렬의 기본행연산을 이용하여 일차연립방정식을 해결하는 방법에 대해 알아봄. 특히 기본행렬과 기본행의 대응에 대해서 설명함. 이 절에서는 이러한 개념을 바탕으로 하여 미지수의 개수와 방정식 개수가 같은 일차연립방정식의 해를 구하는 크래머 공식(Cramer's rule)에 대해 설명함.

### 정리 6.1

다음과 같은 일차연립방정식의 계수행렬 A의 행렬식이 |A| ≠ 0이면

$$\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1\\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2\\
\vdots\\
a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n = b_n
\end{cases}$$

연립방정식은 유일한 해를 가지며, 그 해는

$$x_j = \frac{\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1j-1} & b_1 & a_{1j+1} & \cdots & a_{1n}\\
a_{21} & a_{22} & \cdots & a_{2j-1} & b_2 & a_{2j+1} & \cdots & a_{2n}\\
\vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots\\
a_{n1} & a_{n2} & \cdots & a_{nj-1} & b_n & a_{nj+1} & \cdots & a_{nn}
\end{vmatrix}}{|A|} \quad (단, j = 1, 2, \cdots, n)$$

이며, 여기에서 분자는 계수행렬의 j열을 상수행렬 B = (b₁ b₂ … bₙ)ᵀ로 대체한 행렬식임.

### 크래머 공식의 적용 조건

1. **정방행렬 조건**: 계수행렬 A가 n×n 정방행렬이어야 함
2. **비특이행렬 조건**: |A| ≠ 0 (행렬식이 0이 아님)
3. **유일해 존재**: 위 조건들이 만족되면 유일한 해가 존재함

### 증명 과정

주어진 연립방정식의 계수행렬 A의 |A| ≠ 0이므로 정리 4.1과 정리 5.9에 의해 이 연립방정식은 유일한 해를 가짐. 이때 다음과 같이 상수행렬 B = (b₁ b₂ … bₙ)ᵀ로 행렬 C를 정의:

$$C = \begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1j-1} & b_1 & a_{1j+1} & \cdots & a_{1n}\\
a_{21} & a_{22} & \cdots & a_{2j-1} & b_2 & a_{2j+1} & \cdots & a_{2n}\\
\vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots\\
a_{n1} & a_{n2} & \cdots & a_{nj-1} & b_n & a_{nj+1} & \cdots & a_{nn}
\end{pmatrix}$$

주어진 연립방정식이 해를 가지므로 C에서 j번째 열은 $a_{1j}x_1 + a_{2j}x_2 + \cdots + a_{nj}x_n$로 대신할 수 있음.

행렬식의 j열에 대한 여인수 전개에 의해:
- |C| = (a₁ⱼA₁ⱼ + a₂ⱼA₂ⱼ + … + aₙⱼAₙⱼ)xⱼ = |A|xⱼ
- 따라서 xⱼ = |C|/|A|

### 예제 6.1

크래머 공식을 이용하여 다음 일차연립방정식을 풀어라.

$$\begin{cases}
2x_1 - 3x_2 + 2x_3 = -3\\
x_1 - 2x_2 = 4\\
x_2 - x_3 = 1
\end{cases}$$

**풀이:**

계수행렬의 행렬식이 다음과 같음:

$$|A| = \begin{vmatrix} 
2 & -3 & 2\\ 
1 & -2 & 0\\ 
0 & 1 & -1 
\end{vmatrix} = 3$$

유일한 해를 가지므로 크래머 공식을 적용:

$$x_1 = \frac{1}{3}\begin{vmatrix} 
-3 & -3 & 2\\ 
4 & -2 & 0\\ 
1 & 1 & -1 
\end{vmatrix} = \frac{-6}{3} = -2$$

$$x_2 = \frac{1}{3}\begin{vmatrix} 
2 & -3 & 2\\ 
1 & 4 & 0\\ 
0 & 1 & -1 
\end{vmatrix} = \frac{-9}{3} = -3$$

$$x_3 = \frac{1}{3}\begin{vmatrix} 
2 & -3 & -3\\ 
1 & -2 & 4\\ 
0 & 1 & 1 
\end{vmatrix} = \frac{-12}{3} = -4$$

따라서 해는 x₁ = -2, x₂ = -3, x₃ = -4

### 예제 6.2

다음 동차연립방정식을 풀어라.

$$\begin{cases}
3x_1 + 2x_2 + 7x_3 = 0\\
x_1 + 3x_2 + 4x_3 = 0\\
6x_1 + 4x_2 + 5x_3 = 0
\end{cases}$$

**풀이:**

계수행렬의 행렬식을 구하면:

$$\begin{vmatrix}
3 & 2 & 7\\
1 & 3 & 4\\
6 & 4 & 5
\end{vmatrix} = -63 ≠ 0$$

이므로 연립방정식은 유일한 해를 가짐. 그런데 동차연립방정식은 자명한 해 x₁ = 0, x₂ = 0, x₃ = 0이 유일한 해가 됨 (정리 4.1 참조).

---

## 6.2 행렬식과 역행렬

### 기본 개념

5장의 정리 5.9에서 행렬 A가 역행렬 A⁻¹을 갖기 위한 필요충분조건이 |A| ≠ 0임을 밝혔음. 이 절에서는 |A| ≠ 0일 때 행렬식 |A|를 이용하여 역행렬 A⁻¹을 구하는 방법에 대해 설명함.

### 정의 6.1 - 여인수행렬과 수반행렬

n차 정방행렬 A = (aᵢⱼ)에 대해 (i, j) 원소가 A의 원소 aᵢⱼ에 대한 여인수 Aᵢⱼ인 행렬을 A의 여인수행렬(cofactor matrix)이라 하며 A의 여인수행렬의 전치행렬을 A의 수반행렬(adjoint matrix)이라 하고 adjA로 표시함:

$$adjA = \begin{pmatrix}
A_{11} & A_{12} & \cdots & A_{1n}\\
A_{21} & A_{22} & \cdots & A_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
A_{n1} & A_{n2} & \cdots & A_{nn}
\end{pmatrix}^T = \begin{pmatrix}
A_{11} & A_{21} & \cdots & A_{n1}\\
A_{12} & A_{22} & \cdots & A_{n2}\\
\vdots & \vdots & \ddots & \vdots\\
A_{1n} & A_{2n} & \cdots & A_{nn}
\end{pmatrix}$$

### 예제 6.3

다음 행렬 A에 대한 수반행렬 adjA를 구하라.

$$A = \begin{pmatrix}
1 & 2 & 3\\
3 & 5 & 7\\
2 & 6 & 9
\end{pmatrix}$$

**풀이:**

각 위치의 여인수를 계산함:

<details>
<summary>여인수 계산 과정</summary>

- $A_{11} = +\begin{vmatrix} 5 & 7\\ 6 & 9 \end{vmatrix} = 45 - 42 = 3$
- $A_{12} = -\begin{vmatrix} 3 & 7\\ 2 & 9 \end{vmatrix} = -(27 - 14) = -13$  
- $A_{13} = +\begin{vmatrix} 3 & 5\\ 2 & 6 \end{vmatrix} = 18 - 10 = 8$
- $A_{21} = -\begin{vmatrix} 2 & 3\\ 6 & 9 \end{vmatrix} = -(18 - 18) = 0$
- $A_{22} = +\begin{vmatrix} 1 & 3\\ 2 & 9 \end{vmatrix} = 9 - 6 = 3$
- $A_{23} = -\begin{vmatrix} 1 & 2\\ 2 & 6 \end{vmatrix} = -(6 - 4) = -2$
- $A_{31} = +\begin{vmatrix} 2 & 3\\ 5 & 7 \end{vmatrix} = 14 - 15 = -1$
- $A_{32} = -\begin{vmatrix} 1 & 3\\ 3 & 7 \end{vmatrix} = -(7 - 9) = 2$
- $A_{33} = +\begin{vmatrix} 1 & 2\\ 3 & 5 \end{vmatrix} = 5 - 6 = -1$

</details>

따라서 수반행렬은:

$$adjA = \begin{pmatrix}
3 & 0 & -1\\
-13 & 3 & 2\\
8 & -2 & -1
\end{pmatrix}$$

### 정리 6.2 - 역행렬 공식

n차 정방행렬 A에 대해 |A| ≠ 0일 때 A⁻¹은 다음과 같음:

$$A^{-1} = \frac{adjA}{|A|}$$

### 증명

n차 정방행렬 A = (aᵢⱼ)에 대해 A와 adjA의 곱을 계산하면:

A(adjA)의 (i, j) 원소는:
$$\sum_{k=1}^n a_{ik}A_{jk} = a_{i1}A_{j1} + a_{i2}A_{j2} + \cdots + a_{in}A_{jn}$$

정리 5.3의 따름정리에 의해:
- i = j일 때: 대각성분이 |A|
- i ≠ j일 때: 비대각성분이 모두 0

따라서 A(adjA) = |A|Iₙ이고, |A| ≠ 0이므로:

$$A^{-1} = \frac{adjA}{|A|}$$

### 예제 6.4

예제 6.3의 행렬에 대하여 행렬식과 수반행렬을 이용하여 역행렬을 구하라.

**풀이:**

먼저 행렬식을 구하면:

$$|A| = \begin{vmatrix}
1 & 2 & 3\\
3 & 5 & 7\\
2 & 6 & 9
\end{vmatrix}$$

R₁,₂(-3)과 R₁,₃(-2)를 적용하면:

$$= \begin{vmatrix}
1 & 2 & 3\\
0 & -1 & -2\\
0 & 2 & 3
\end{vmatrix}$$

R₂,₃(2)를 적용하면:

$$= 1 × (-1) × (-1) = 1$$

따라서 정리 6.2에 따라:

$$A^{-1} = \frac{adjA}{|A|} = \frac{1}{1}\begin{pmatrix}
3 & 0 & -1\\
-13 & 3 & 2\\
8 & -2 & -1
\end{pmatrix} = \begin{pmatrix}
3 & 0 & -1\\
-13 & 3 & 2\\
8 & -2 & -1
\end{pmatrix}$$

### 예제 6.5

다음 행렬 A의 역행렬 A⁻¹을 |A|와 adjA를 이용하여 구하라.

$$A = \begin{pmatrix}
2 & -2 & 1\\
3 & 2 & 0\\
1 & -3 & -5
\end{pmatrix}$$

**풀이:**

주어진 행렬을 A로 놓으면:

$$|A| = \begin{vmatrix}
2 & -2 & 1\\
3 & 2 & 0\\
1 & -3 & -5
\end{vmatrix} = -61$$

다음 adjA를 구하면:

$$adjA = \begin{pmatrix}
-10 & -13 & -2\\
15 & -11 & 3\\
-11 & 4 & 10
\end{pmatrix}$$

이므로 A⁻¹은:

$$A^{-1} = \frac{1}{-61}\begin{pmatrix}
-10 & -13 & -2\\
15 & -11 & 3\\
-11 & 4 & 10
\end{pmatrix} = \begin{pmatrix}
\frac{10}{61} & \frac{13}{61} & \frac{2}{61}\\
-\frac{15}{61} & \frac{11}{61} & -\frac{3}{61}\\
\frac{11}{61} & -\frac{4}{61} & -\frac{10}{61}
\end{pmatrix}$$

---

## 6.3 크래머 공식과 역행렬의 관계

### 정리 6.3

일차연립방정식 AX = B는 |A| ≠ 0일 때 유일한 해 X = A⁻¹B를 가짐.

### 크래머 공식의 일반적 형태

크래머 공식에 따르면 일차연립방정식 AX = B에서 |A| ≠ 0일 때의 해는:

$$x_j = \frac{b_1A_{1j} + b_2A_{2j} + \cdots + b_nA_{nj}}{|A|} \quad (단, 1 \leq j \leq n)$$

로 표현할 수 있으며, 이는 다음과 같이 행렬 형태로 나타낼 수 있음:

$$X = \frac{1}{|A|} \begin{pmatrix}
A_{11} & A_{21} & \cdots & A_{n1}\\
A_{12} & A_{22} & \cdots & A_{n2}\\
\vdots & \vdots & \ddots & \vdots\\
A_{1n} & A_{2n} & \cdots & A_{nn}
\end{pmatrix}\begin{pmatrix}
b_1\\
b_2\\
\vdots\\
b_n
\end{pmatrix} = \frac{adjA}{|A|}B = A^{-1}B$$

### 예제 6.6

정리 6.3을 이용하여 다음 일차연립방정식의 해를 구하라.

$$\begin{cases}
2x + 6y + 4z = -6\\
3x + 2y - 3z = 22\\
x + 4y = 9
\end{cases}$$

**풀이:**

위의 연립방정식에 대응하는 계수, 미지수, 상수행렬은 각각:

$$A = \begin{pmatrix}
2 & 6 & 4\\
3 & 2 & -3\\
1 & 4 & 0
\end{pmatrix}, \quad X = \begin{pmatrix} x \\ y \\ z \end{pmatrix}, \quad B = \begin{pmatrix} -6 \\ 22 \\ 9 \end{pmatrix}$$

|A|를 구하면:

$$|A| = \begin{vmatrix} 
2 & 6 & 4\\ 
3 & 2 & -3\\ 
1 & 4 & 0 
\end{vmatrix} = 46$$

A⁻¹ = |A|⁻¹ · adjA이므로 수반행렬을 계산하면:

$$adjA = \begin{pmatrix}
12 & 16 & -26\\
-3 & -4 & 18\\
10 & -2 & -14
\end{pmatrix}$$

따라서:

$$A^{-1} = \frac{1}{46}\begin{pmatrix}
12 & 16 & -26\\
-3 & -4 & 18\\
10 & -2 & -14
\end{pmatrix}$$

연립방정식의 해는:

$$X = A^{-1}B = \frac{1}{46}\begin{pmatrix}
12 & 16 & -26\\
-3 & -4 & 18\\
10 & -2 & -14
\end{pmatrix}\begin{pmatrix}
-6\\
22\\
9
\end{pmatrix} = \begin{pmatrix}
1\\
-2\\
-5
\end{pmatrix}$$

### 예제 6.7

다음 연립방정식이 유일한 해를 가질 실수 a의 조건과 그때의 해를 구하라.

$$\begin{cases}
2x_1 - 3x_2 + 2x_3 = -3\\
x_1 - 2x_2 = 4\\
x_2 + ax_3 = 1
\end{cases}$$

**풀이:**

계수행렬 A의 행렬식이 0이 아니면 연립방정식이 유일해를 가지므로, 역행렬을 이용하면 이 방정식은:

$$|A| = \begin{vmatrix}
2 & -3 & 2\\
1 & -2 & 0\\
0 & 1 & a
\end{vmatrix} = 2 \cdot (-2a) + (-3) \cdot a + 2 \cdot 1 = -a + 2$$

이므로 a ≠ 2이면 유일한 해를 가짐. 해를 구하기 위해서 역행렬을 구해 보자.

여인수들을 계산하면:
- A₁₁ = -2a, A₁₂ = -a, A₁₃ = 1  
- A₂₁ = 3a + 2, A₂₂ = 2a, A₂₃ = -2
- A₃₁ = 4, A₃₂ = 2, A₃₃ = -1

따라서:

$$A^{-1} = \frac{1}{-a + 2}\begin{pmatrix}
-2a & 3a + 2 & 4\\
-a & 2a & 2\\
1 & -2 & -1
\end{pmatrix}$$

따라서 구하는 해는:

$$X = \frac{1}{-a + 2}\begin{pmatrix}
-2a & 3a + 2 & 4\\
-a & 2a & 2\\
1 & -2 & -1
\end{pmatrix}\begin{pmatrix}
-3\\
4\\
1
\end{pmatrix} = \frac{1}{-a + 2}\begin{pmatrix}
18a + 12\\
11a + 2\\
-12
\end{pmatrix}$$

즉:
- $x_1 = \frac{18a + 12}{-a + 2}$
- $x_2 = \frac{11a + 2}{-a + 2}$  
- $x_3 = \frac{-12}{-a + 2}$

여기서 a = -1이라면 x₁ = -2, x₂ = -3, x₃ = -4가 되어 예제 2.11에서 구한 결과와 일치함.

---

## [참고] 행렬식을 이용한 삼각형의 면적

### 기본 공식

좌표평면에서 세 점 A(x₁, y₁), B(x₂, y₂), C(x₃, y₃)로 이루어진 삼각형의 면적은 다음과 같이 구할 수 있음:

$$\text{삼각형의 면적} = \pm\frac{1}{2}\begin{vmatrix}
x_1 & y_1 & 1\\
x_2 & y_2 & 1\\
x_3 & y_3 & 1
\end{vmatrix}$$

면적은 항상 양수이므로 절댓값을 취함.

### 평행사변형의 면적

벡터 **a** = (a, c), **b** = (b, d)로 이루어진 평행사변형의 면적:

$$\text{평행사변형의 면적} = \left|\begin{vmatrix} a & b\\ c & d \end{vmatrix}\right| = |ad - bc|$$

### 예제: 삼각형 면적 계산

세 점 A(5, 6), B(2, 1), C(6, 3)로 이루어진 삼각형의 면적을 구해보자.

**풀이:**

$$\text{면적} = \pm\frac{1}{2}\begin{vmatrix}
5 & 6 & 1\\
2 & 1 & 1\\
6 & 3 & 1
\end{vmatrix}$$

행렬식을 계산하면:
- 첫 번째 행으로 전개: $5(1-3) - 6(2-6) + 1(6-6) = 5(-2) - 6(-4) + 0 = -10 + 24 = 14$

따라서 면적 = $\frac{1}{2} × |14| = 7$

---

## Gabriel Cramer (1704-1752)

스위스의 수학자 Gabriel Cramer는 1750년 "Introduction to the analysis of algebraic curved lines"라는 저서를 통해 연립방정식의 해를 구하는 체계적인 방법을 제시했음. 이것이 현재 우리가 사용하는 크래머 공식의 기원이 됨.

---

## 요약

### 핵심 개념

1. **크래머 공식**: 행렬로 표현한 일차연립방정식 AX = B의 해를 구하는 방법으로 행렬식을 이용하는 크래머 공식은 계수행렬 A의 행렬식이 |A| ≠ 0일 때 사용할 수 있고, 그 해는 다음 식으로 구함:

   $$x_j = \frac{\begin{vmatrix}
   a_{11} & a_{12} & \cdots & a_{1j-1} & b_1 & a_{1j+1} & \cdots & a_{1n}\\
   a_{21} & a_{22} & \cdots & a_{2j-1} & b_2 & a_{2j+1} & \cdots & a_{2n}\\
   \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots\\
   a_{n1} & a_{n2} & \cdots & a_{nj-1} & b_n & a_{nj+1} & \cdots & a_{nn}
   \end{vmatrix}}{|A|} \quad (j = 1, 2, \ldots, n)$$

   즉, 주어진 일차연립방정식의 유일한 해 X의 j번째 미지수 xⱼ를 구하기 위해서 위 식의 분자인 행렬식은 계수행렬 A의 j열을 상수행렬 B = (b₁ b₂ ⋯ bₙ)ᵀ로 대체하여 계산함

2. **수반행렬과 역행렬**: 역행렬은 4.2절에서 행렬의 기본행연산을 이용하여 구하는 방법 이외에 행렬식이 0이 아닌 행렬에 한해 행렬식을 구할 수 있으며, n차 정방행렬 A에 대해 |A| ≠ 0이면, A의 수반행렬:

   $$adjA = \begin{pmatrix}
   A_{11} & A_{21} & \cdots & A_{n1}\\
   A_{12} & A_{22} & \cdots & A_{n2}\\
   \vdots & \vdots & \ddots & \vdots\\
   A_{1n} & A_{2n} & \cdots & A_{nn}
   \end{pmatrix}$$

   을 정의하고, 행렬 A와 그 수반행렬 adjA를 곱하면 대각성분이 모두 |A|이고 나머지 성분은 모두 0인 스칼라행렬을 얻을 수 있음. 따라서, 행렬 A의 역행렬은:

   $$A^{-1} = \frac{adj(A)}{|A|}$$

3. **역행렬을 이용한 해법**: 행렬로 표현한 일차연립방정식 AX = B에 대해, 계수행렬 A의 행렬식이 |A| ≠ 0이면, A의 역행렬 A⁻¹을 구한 후 방정식의 양변에 곱하여 해 X = A⁻¹B를 얻을 수 있음. 이 방법은 일차방정식 ax = b의 해를 구하는 방법과 유사하며, 정리하면, 일차연립방정식 AX = B의 해는 |A| ≠ 0이면, A의 수반행렬 adjA와 행렬식 |A|을 이용하여 역행렬 A⁻¹ = adjA/|A|을 구한 후 X = A⁻¹B를 계산하면 됨

### 두 방법의 연관성

- 크래머 공식과 역행렬 방법은 본질적으로 동일한 결과를 제공함
- 둘 다 행렬식과 여인수의 개념에 기반함  
- 계산량 측면에서는 가우스-조던 소거법이 더 효율적임
- 이론적 이해와 작은 크기 행렬에 대해서는 유용함

### 실용적 고려사항  

1. **계산 복잡성**: n×n 행렬에 대해 O(n!) 시간 복잡도
2. **수치적 안정성**: 큰 행렬에서는 부동소수점 오차 누적 가능
3. **적용 범위**: 주로 2×2, 3×3 행렬에서 실용적  
4. **교육적 가치**: 선형대수학의 핵심 개념 이해에 중요함
